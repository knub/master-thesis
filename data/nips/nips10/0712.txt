Silicon Retina with Adaptive Filtering 
Properties 
Shih-Chii Liu 
Computation and Neural Systems 
136-93 California Institute of Technology 
Pasadena, CA 91125 
shih@pcmp.caltech.edu 
Abstract 
This paper describes a small, compact circuit that captures the 
temporal and adaptation properties both of the photoreceptor and 
of the laminar layers of the fly. This circuit uses only six transis- 
tors and two capacitors. It is operated in the subthreshold domain. 
The circuit maintains a high transient gain by using adaptation to 
the background intensity as a form of gain control. The adapta- 
tion time constant of the circuit can be controlled via an external 
bias. Its temporal filtering properties change with the background 
intensity or signal-to-noise conditions. The frequency response of 
the circuit shows that in the frequency range of I to 100 Hz, the 
circuit response goes from highpass filtering under high light levels 
to lowpass filtering under low light levels (i.e., when the signal-to- 
noise ratio is low). A chip with 20x20 pixels has been fabricated 
in 1.2um ORBIT CMOS nwell technology. 
1 BACKGROUND 
The first two layers in the fly visual system are the retina layer and the laminar 
layer. The photoreceptors in the retina synapse onto the monopolar cells in the 
laminar layer. The photoreceptors adapt to the background intensity, and use this 
adaptation as a form of gain control in maintaining a high response to transient 
signals. The laminar layer performs bandpass filtering under high background in- 
tensities, and reverts to lowpass filtering in the case of low background intensities 
where the signal-to-noise (S/N) ratio is low. This adaptive filtering response in the 
temporal domain is analogous to the spatial center-surround response of the bipolar 
cells in the vertebrate retina. 
Silicon Retina with Adaptive Filtering Properties 713 
V r 
Vm. Q 3 Vb 
Figure 1: Circuit diagram of retino-laminar circuit. The feedback consists of a 
resistor implemented by a pFET transistor, Q1. The conductance of the resistor is 
controlled by the external bias, Vm. 
ga 
Cr?__ g m Cd Ci 
5(Vpi.vr/k) gm2Vr 
vi 
Figure 2: Small signal model of the circuit shown in Figure 1. Cr is the parasitic 
capacitance at the node, Vt. 
The Delbriick silicon receptor circuit (Delbriick, 1994) modeled closely the step re- 
sponses and the adaptation responses of the biological receptors. By including two 
additional transistors, the retino-laminar (RL) circuit described here captures 
the properties of both the photoreceptor layer (i.e., the adaptation properties and 
phototransduction) and the cells in the laminar layer (i.e., the adaptive filtering). 
The time constant of the circuit is controllable via an external bias, and the adapta- 
tion behavior of the circuit over different background intensities is more symmetrical 
than that of Delbriick's photoreceptor circuit. 
2 CIRCUIT DESCRIPTION 
The RL circuit which has the basic form of Delbriick's receptor circuit is shown 
in Figure 1. I have replaced the adaptive element in his receptor circuit by a 
nonlinear resistor consisting of a pFET transistor, Q1. The implementation of a 
floating, voltage-controlled resistor has been described earlier by (Banu and Tsividis, 
1982). The bias for Q1, Vb, is generated by Qa and Q4. The conductance of Q 
is determined by the output voltage, I/i, and an external bias, Vm. We give a brief 
description of the circuit operation here; details are described in (Delbriick, 1994). 
The receptor node, , is clamped to the voltage needed to sink the current sourced 
714 $-C. Liu 
( % 
10[ , , . ......................................... 
10 ø 10 1 10 2 10  10 4 10  
Frequency (Hz) 
Figure 3: Frequency plot of the RL circuit over five decades of background intensity. 
The number next to each curve corresponds to the log intensity of the mean value; 
0 log corresponds to the intensity of a red LED. The plot shows that, in the range 
of 1 to 100 Hz, the circuit is a bandpass filter at high light levels, and reduces to a 
lowpass filter at low light levels. 
by Q6, which is biased by an external voltage, Vu. Changes in the photocurrent are 
amplified by the transistors, Q2 and Q6, resulting in a change in l(. This change in 
l( is capacitively coupled through the capacitive divider, consisting of (72 and (70, 
into Vp, so that Q5 supplies the extra increase in photocurrent. 
The feedback transistor, Qs, is operated in subthreshold so that V and l( is loga- 
rithmic in the photocurrent. A large change in the photocurrent resulting from a 
change in the background intensity, leads to a large change in the circuit output, 
l(. Significant current then flows through Q, thus charging or discharging Vp. 
3 PROPERTIES OF RL CIRCUIT 
The temporal responses and adaptation properties of this circuit are expounded 
in the following sections. In Section 3.1, we solve for the transfer function of the 
circuit and in Section 3.2, we describe the dependence of the conductance of Q 
on the background intensity. In Sections 3.3 and 3.4, we describe the temporal 
responses of this circuit, and compare the adaptation response of RL circuit with 
that of Delbrfick's circuit. 
3.1 TRANSFER FUNCTION 
We can solve for the transfer function of the RL circuit in Figure I by writing the 
KCL equations of the small-signal model shown in Figure 2. The transfer function, 
vt is given by: 
vt 1 
in gin5 
Srl "F g. 
$TId 
Cm- + + + + 1 
(1) 
Silicon Retina with Adaptive Filtering Properties 715 
Time (sec) 
Figure 4: Temporal responses of the circuit over five decades of background inten- 
sity. The input stimulus is a square-wave-modulated red LED of contrast 0.15. The 
circuit acts as a highpass filter (that is, a differentiator) at high intensities, and as 
a lowpass filter as the intensity drops. 
where Aarnp -- g,2 
ga ' grn is the transconductance, and ge is the output conductance 
of a transistor. We define the time constants, rt, rr, and rta, as follows: 
TI --' ; Tr --- ; Tld -- , 
]rn2 ]rn5 ]rn2 
where ga is the output conductance of Q and Cr is the parasitic capacitance at the 
node, Vt. 
The frequency response curves in Figure 3 are measured from the fabricated circuit 
over five decades of background intensity. We obtain the curves by using a sine- 
wave-modulated red LED source. The number next to each curve is the log intensity 
of the mean value; 0 log is the intensity of a red LED. We obtain the remaining 
curves by interposing neutral density filters between the LED source and the chip. 
Figure 3 shows that, in the range of I to 100 Hz, the circuit is a bandpass filter 
at high light levels, and reduces to a lowpass filter at low light levels. For each 
c+½d The 
frequency curve, the gain is flat in the middle, and is given by Ad = ci 
cutoff frequencies change with the background intensity; this change is analyzed in 
Section 3.2. 
3.2 
DEPENDENCE OF CIRCUIT'S TIME CONSTANT ON 
BACKGROUND INTENSITY 
The cutoff frequencies of the circuit depend on the conductance, ga, of Q. Here, 
we analyze the dependence of g on the background intensity. Since Q is operated 
in subthreshold, the conductance depends on the current flowing through Q. The 
I-V relationship for Q1 can be written as 
I = 2Iop(i-) 'pe (1 sinh(AV/2) (2) 
= IIh  sinh(AV/2) (3) 
where V - +ve AV = - Vpi Iph is the photocurrent, d Ia = 
2Iop (    t ev  (-')/' 
o.   / The exponenti relationship for Equations 2 and 3 
is for a FET transistor operating in subthreshold, where lop is the quiescent leak- 
age current of the transistor, and n is the effectiveness of the gate in controlling 
S-C. Liu 
716 
21 
16 
1.4 
1.2 
0.8 
0 
-3 j  , -3 
 ~3  -4 
light to dark 
   70 
Time (sec) 
Figure 5: Plots of adaptation responses of the RL circuit and of Delbrfick's circuit. 
The input stimulus is a red LED driven by a square wave of contrast 0.18. The 
bottom curve corresponding to Delbrfick's receptor has been shifted down so that 
we can compare the two curves. The adaptation response of the RL circuit is more 
symmetrical than that of Delbrfick's circuit when the circuit goes from dark to light 
conditions and back. 
the surface potential of the channel of the transistor. Equation 3 shows that ga 
is proportional to the photocurrent, Iph, hence, the background intensity. A more 
intuitive way of understanding how ga changes with Iph is that the change in Vv 
with a fixed change in the output, I4, depends on the output level of V. The change 
in Vv is larger for a higher DC output, V, because of the increased body effect at 
Q4 due to its higher source voltage. The larger change in V leads to an increase in 
the conductance, ga. 
As Iph increases, ga increases, so the cutoff frequencies shift to the right, as seen in 
Figure 3. If we compare both the "0" curve and the "-1" curve, we can see that the 
cutoff frequencies are approximately different by a factor of 10. Thus, the exponent 
of Iph, (1 - nnnp)/n,  1. Since the n values change with the current through the 
transistor, the exponent also changes. The different values of the exponent with 
Iph can be seen from the different amounts of shifts in the cutoff frequencies of the 
curves. 
3.3 TEMPORAL RESPONSES 
The adaptive temporal filtering of the circuit over five decades of background in- 
tensity can also be observed from the step response of the RL circuit to a square- 
wave-modulated LED of contrast 0.15, as shown in Figure 4. The data in Figure 
4 show that the time constant of the circuit increases as the light level decreases. 
The temporal responses observed in these circuits are comparable to the contrast 
responses recorded from the LMCs by Juusola and colleagues (Juusola et ed., 1995). 
3.4 ADAPTATION PROPERTIES 
The RL circuit also differs from Delbrfick's circuit in that the adaptation time 
constant can be set by an external bias. In the Delbrfick circuit, the adaptation time 
constant is predetermined at the design phase and by process parameters. In Figure 
5, we compare the adaptation properties of the RL circuit with those of Delbrfick's 
Silicon Retina with Adaptive Filtering Properties 717 
75 
1.7 
V m-:0.73.0.78. 0.8. 0.84.0.87. 0.9 
0'3 o' o o16 
Time (sec) 
Figure 6: Step response of the RL circuit for different values of Vm. The input 
stimulus is a square-wave-modulated red LED source. The value of Vm was varied 
from 0.73 to 0.9 V. The curve with the longest time constant of decay corresponds 
to the lowest value of Vm. 
circuit. The input stimulus consists of a square-wave-modulated LED source with 
a contrast of about 0.18. We take the circuit from dark to light conditions, and 
back again, by using neutral density filters. The top curve corresponds to the 
response from the RL circuit, and the bottom curve corresponds to the response 
from the Delbriick circuit. The RL circuit adapts symmetrically, when it goes 
from light to dark conditions and back. In contrast, Delbriick's circuit shows an 
asymmetrical adaptative behavior; it adapts more slowly when it goes from dark to 
light conditions. 
The adaptation time constant of the RL circuit depends on the conductance, 
and the capacitors, Ct and Ca. From Equation 3, we see that ga is dependent on 
which is set by the bias, Vm. Hence, we can change the adaptation time constant by 
varying Vm. The dependence of the time constant on Vm is further demonstrated 
by recording the step response of the circuit to a LED source of contrast 0.15 for 
various values of Vm. The output data is shown in Figure 6 for five different values 
of Vm. The time constant of the circuit decreases as Vm increases. 
A chip consisting of 20x20 pixels was fabricated in 1.2/m ORBIT CMOS nwell 
technology. An input stimulus consisting of a rotating flywheel, with black strips 
on a white background, was initially presented to the imager. The flywheel was then 
stopped, and the response of the chip was recorded one sec after the motion was 
ceased. I repeated the experiment for two adaptation time constants by changing 
the value of Vm. Figure 7a shows the output of the chip with the longer adaptation 
time constant. We see that the image is still present, whereas the image in Figure 
7b has almost faded away; that is, the chip has adapted away the stationary image. 
4 CONCLUSIONS 
I have described a small circuit captures the temporal and adaptation properties 
of both the photoreceptor and the laminar layers in the fly retina. By adapting to 
the background intensity, the circuit maintains a high transient gain. The temporal 
behavior of the circuit also changes with the background intensity, such that, at 
high S/N ratios, the circuit acts as a highpass filter and, at low S/N ratios, the 
circuit acts as a lowpass filter to average out the noise. The circuit uses only six 
transistors and two capacitors and is compact. The adaptation time constant of the 
718 S-C. Liu 
(a) 
Figure 7: Adaptation results from a two-dimensional array of 20 x 20 pixels. The 
output of the array was recorded one sec after cessation of the pattern motion. 
The experiment was repeated for two different adaptation time constants. Figure 
(a) corresponds to the longer adaptation time constant. The image is still present, 
whereas the image in Figure (b) has almost faded away. 
circuit can be controlled via an external bias. 
Acknowledgments 
I thank Bradley A. Minch for discussions of this work, Carver Mead for supporting 
this work, and the MOSIS foundation for fabricating this circuit. I also thank Lyn 
Dupre for editing this document. This work was supported in part by the Office of 
Naval Research, by DARPA, and by the Beckman Foundation. 
References 
T. Delbrfick, "Analog VLSI phototransduction by continous-time, adaptive, loga- 
rithmic photoreceptor circuits," CN$ Memo No.$O, California Institute of Technol- 
ogy, Pasadena, CA, 1994. 
M. Banu and Y. Tsividis, "Floating voltage-controlled resistors in CMOS technol- 
ogy," Electronics Letters, 18:15, pp. 678-679, 1982. 
M. Juusola, R.O. Uusitola, and M. Weckstrom, "Transfer of graded potentials at 
the photoreceptor-interneuron synapse," J. of General Physiology, 105, pp. 115- 
148, 1995. 
